# Suicide Risk Prediction ML

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue.svg)](https://python.org)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.0%2B-red.svg)](https://pytorch.org)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.100%2B-green.svg)](https://fastapi.tiangolo.com)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.28%2B-orange.svg)](https://streamlit.io)
[![License](https://img.shields.io/badge/License-Educational-lightgrey.svg)](#license)

A machine learning-based mental health risk assessment system that predicts suicide risk probability using psychological indicators. The project features a PyTorch logistic regression model, FastAPI backend, and Streamlit web interface.

---

> **IMPORTANT DISCLAIMER**
>
> This tool is developed strictly for **educational and research purposes**. It is **NOT** a substitute for professional mental health evaluation, diagnosis, or treatment. The predictions generated by this model should not be used as the sole basis for any clinical decisions.
>
> If you or someone you know is experiencing a mental health crisis, please contact a qualified mental health professional or emergency services immediately.

---

## Table of Contents

1. [Project Overview](#project-overview)
2. [Key Features](#key-features)
3. [System Architecture](#system-architecture)
4. [Dataset Description](#dataset-description)
5. [Model Specification](#model-specification)
6. [Performance Metrics](#performance-metrics)
7. [Installation Guide](#installation-guide)
8. [Usage Instructions](#usage-instructions)
9. [API Documentation](#api-documentation)
10. [Project Structure](#project-structure)
11. [Deployment Guide](#deployment-guide)
12. [Configuration](#configuration)
13. [Troubleshooting](#troubleshooting)
14. [Contributing](#contributing)
15. [Mental Health Resources](#mental-health-resources)
16. [License](#license)

---

## Project Overview

This project implements an end-to-end machine learning pipeline for suicide risk prediction based on psychological indicators. The system processes five key mental health metrics and outputs a probability score indicating potential risk levels.

### Components

| Component | Technology | Purpose |
|-----------|------------|---------|
| Data Analysis & Training | Jupyter Notebook, scikit-learn | Exploratory data analysis, feature engineering, model training |
| Backend API | FastAPI, Uvicorn | RESTful inference endpoint with CORS support |
| Frontend Interface | Streamlit | Interactive web-based user interface |
| ML Model | PyTorch | Logistic regression classifier |

### Workflow

```
User Input → Streamlit UI → HTTP Request → FastAPI Backend → PyTorch Model → Risk Probability → Response
```

---

## Key Features

| Feature | Description |
|---------|-------------|
| Real-time Inference | Sub-second prediction response times |
| RESTful API | Standard HTTP endpoints for easy integration |
| CORS Support | Cross-origin requests enabled for flexible deployment |
| Class Imbalance Handling | Weighted loss function for imbalanced dataset |
| Three-tier Risk Classification | Low, Moderate, and High risk categories with thresholds |
| Dark Theme UI | Modern, accessible interface design |
| Interactive Sliders | Intuitive input controls for psychological scores |

---

## System Architecture

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                              CLIENT LAYER                                     │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│    ┌─────────────────────────────────────────────────────────────────┐      │
│    │                     STREAMLIT APPLICATION                        │      │
│    │  ┌───────────────┐  ┌───────────────┐  ┌───────────────────┐   │      │
│    │  │ Input Sliders │  │ Risk Display  │  │ Guidance Messages │   │      │
│    │  └───────────────┘  └───────────────┘  └───────────────────┘   │      │
│    └─────────────────────────────────────────────────────────────────┘      │
│                                    │                                         │
│                                    │ HTTP POST /predict                      │
│                                    ▼                                         │
├──────────────────────────────────────────────────────────────────────────────┤
│                              SERVER LAYER                                     │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│    ┌─────────────────────────────────────────────────────────────────┐      │
│    │                      FASTAPI APPLICATION                         │      │
│    │  ┌───────────────┐  ┌───────────────┐  ┌───────────────────┐   │      │
│    │  │ CORS Handler  │  │ Input Schema  │  │ Response Schema   │   │      │
│    │  │ (Middleware)  │  │ (Pydantic)    │  │ (JSON)            │   │      │
│    │  └───────────────┘  └───────────────┘  └───────────────────┘   │      │
│    └─────────────────────────────────────────────────────────────────┘      │
│                                    │                                         │
│                                    ▼                                         │
├──────────────────────────────────────────────────────────────────────────────┤
│                              MODEL LAYER                                      │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│    ┌─────────────────────────────────────────────────────────────────┐      │
│    │                    PYTORCH INFERENCE ENGINE                      │      │
│    │  ┌───────────────┐  ┌───────────────┐  ┌───────────────────┐   │      │
│    │  │ Model Loader  │  │ Tensor Ops    │  │ Sigmoid Activation│   │      │
│    │  └───────────────┘  └───────────────┘  └───────────────────┘   │      │
│    └─────────────────────────────────────────────────────────────────┘      │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## Dataset Description

### Source

The model is trained on `suicide_risk_synthetic_10k.csv`, a synthetic dataset containing **10,000 records** designed for mental health risk prediction research.

### Feature Dictionary

| Feature | Data Type | Range/Values | Description |
|---------|-----------|--------------|-------------|
| `Person_ID` | Integer | 1-10000 | Unique identifier (excluded from training) |
| `Age` | Integer | 18-65 | Age in years |
| `Depression_Score` | Float | 0-10 | Severity of depressive symptoms |
| `Anxiety_Score` | Float | 0-10 | Severity of anxiety symptoms |
| `Stress_Level` | Float | 0-10 | Current stress level |
| `Sleep_Quality` | Categorical | Poor, Average, Good | Sleep quality rating |
| `Social_Support_Score` | Float | 0-10 | Perceived social support |
| `Self_Esteem_Score` | Float | 0-10 | Self-esteem level |
| `Academic_or_Work_Stress` | Categorical | Low, Medium, High | Work/academic stress |
| `Previous_Mental_Health_Diagnosis` | Binary | Yes, No | Prior mental health diagnosis |
| `Substance_Use` | Binary | Yes, No | Substance use indicator |
| `Recent_Life_Event` | Binary | Yes, No | Recent significant life event |
| `Physical_Health_Issues` | Binary | Yes, No | Physical health problems |
| `Help_Seeking_Behavior` | Binary | Yes, No | History of seeking help |
| `Suicide_Risk` | Binary | Yes, No | **Target variable** |

### Feature Selection Methodology

Correlation analysis was performed to identify the most predictive features:

```
Correlations with Suicide_Risk (Target):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Anxiety_Score                    +0.297
Stress_Level                     +0.288
Depression_Score                 +0.285
Social_Support_Score             -0.268
Self_Esteem_Score                -0.259
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**Selection Criteria**: Features with |correlation| >= 0.1 were retained.

**Final Feature Set** (5 features):
- `Depression_Score`
- `Anxiety_Score`
- `Stress_Level`
- `Social_Support_Score`
- `Self_Esteem_Score`

### Class Distribution

| Class | Label | Count | Percentage |
|-------|-------|-------|------------|
| No Risk | 0 | 8,674 | 86.74% |
| At Risk | 1 | 1,326 | 13.26% |

**Note**: The dataset exhibits class imbalance (ratio ~6.5:1), which is addressed using weighted loss during training.

---

## Model Specification

### Architecture

The model implements a binary logistic regression classifier using PyTorch:

```python
class LogisticRegressionModel(nn.Module):
    """
    Binary classification model for suicide risk prediction.
    
    Input:  Tensor of shape (batch_size, 5)
    Output: Tensor of shape (batch_size, 1) - raw logits
    """
    def __init__(self, input_dim=5):
        super().__init__()
        self.linear = nn.Linear(input_dim, 1)
    
    def forward(self, x):
        return self.linear(x)
```

### Training Configuration

| Parameter | Value | Rationale |
|-----------|-------|-----------|
| Optimizer | Adam | Adaptive learning rate, momentum |
| Learning Rate | 0.0001 | Conservative for stable convergence |
| Epochs | 100,000 | Extended training for convergence |
| Loss Function | BCEWithLogitsLoss | Numerically stable, built-in sigmoid |
| pos_weight | ~6.54 | Compensates for class imbalance |
| Train/Test Split | 80/20 | Standard split ratio |
| Stratification | Enabled | Preserves class distribution |
| Random State | 42 | Reproducibility |

### Inference Pipeline

```
Input Features [5] → Linear Layer → Logits [1] → Sigmoid → Probability [0,1]
```

### Risk Classification Thresholds

| Probability Range | Risk Level | Recommended Action |
|-------------------|------------|-------------------|
| p < 0.30 | Low | Self-monitoring, maintain support network |
| 0.30 ≤ p < 0.60 | Moderate | Consider professional consultation |
| p ≥ 0.60 | High | Seek immediate professional support |

---

## Performance Metrics

Model evaluation on the held-out test set (n=2,000):

| Metric | Value |
|--------|-------|
| Accuracy | ~73% |
| Dataset Split | 80% train / 20% test |
| Validation Method | Stratified split |

**Note**: Detailed classification metrics (precision, recall, F1-score) are available in the training notebook (`src.ipynb`).

---

## Installation Guide

### Prerequisites

| Requirement | Version |
|-------------|---------|
| Python | 3.8 or higher |
| pip | Latest recommended |
| Git | For cloning repository |

### Step-by-Step Installation

**1. Clone the Repository**

```bash
git clone https://github.com/yourusername/suicide-risk-prediction-ml.git
cd suicide-risk-prediction-ml
```

**2. Create Virtual Environment**

```bash
# Create environment
python -m venv venv

# Activate (Windows)
venv\Scripts\activate

# Activate (macOS/Linux)
source venv/bin/activate
```

**3. Install Dependencies**

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### Dependencies

| Package | Purpose |
|---------|---------|
| `pandas` | Data manipulation and analysis |
| `numpy` | Numerical computing |
| `torch` | Deep learning framework |
| `scikit-learn` | ML utilities and metrics |
| `fastapi` | Backend API framework |
| `uvicorn` | ASGI server |
| `streamlit` | Frontend web application |
| `pydantic` | Data validation |

---

## Usage Instructions

### Running the Application Locally

**Terminal 1: Start Backend Server**

```bash
python backend.py
```

Expected output:
```
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000
```

**Terminal 2: Start Frontend Application**

```bash
streamlit run app.py
```

The application will automatically open in your default browser at `http://localhost:8501`.

### Using the Web Interface

1. **Input Parameters**: Use the sliders to set values (0-10) for each psychological indicator:
   - Depression Score
   - Anxiety Score
   - Stress Level
   - Social Support Score
   - Self-Esteem Score

2. **Generate Prediction**: Click the "Predict Risk" button

3. **Interpret Results**: View the probability score and risk level classification with contextual guidance

---

## API Documentation

### Base URLs

| Environment | URL |
|-------------|-----|
| Local Development | `http://localhost:8000` |
| Production | `https://suicide-risk-prediction-ml-backend.onrender.com` |

### Endpoints

#### Health Check

```
GET /
```

**Response** `200 OK`

```json
{
    "message": "Suicide Risk Prediction API",
    "docs": "/docs"
}
```

---

#### Predict Risk

```
POST /predict
Content-Type: application/json
```

**Request Body Schema**

| Field | Type | Required | Range | Description |
|-------|------|----------|-------|-------------|
| `Depression_Score` | float | Yes | 0-10 | Depression severity |
| `Anxiety_Score` | float | Yes | 0-10 | Anxiety severity |
| `Stress_Level` | float | Yes | 0-10 | Stress level |
| `Social_Support_Score` | float | Yes | 0-10 | Social support |
| `Self_Esteem_Score` | float | Yes | 0-10 | Self-esteem |

**Example Request**

```json
{
    "Depression_Score": 7.5,
    "Anxiety_Score": 6.0,
    "Stress_Level": 8.0,
    "Social_Support_Score": 3.0,
    "Self_Esteem_Score": 4.0
}
```

**Response** `200 OK`

```json
{
    "suicide_risk_probability": 0.73
}
```

**Response Fields**

| Field | Type | Description |
|-------|------|-------------|
| `suicide_risk_probability` | float | Probability value between 0 and 1 |

---

#### Interactive Documentation

```
GET /docs
```

Access the auto-generated Swagger UI for interactive API testing.

---

## Project Structure

```
suicide-risk-prediction-ml/
│
├── app.py                            # Streamlit frontend application
│                                     # - Dark theme CSS styling
│                                     # - Input slider components
│                                     # - Risk visualization
│                                     # - Backend API integration
│
├── backend.py                        # FastAPI backend server
│                                     # - CORS middleware configuration
│                                     # - Pydantic input validation
│                                     # - Model loading and inference
│                                     # - REST endpoints
│
├── src.ipynb                         # Jupyter notebook
│                                     # - Data loading and exploration
│                                     # - Feature engineering
│                                     # - Correlation analysis
│                                     # - Model training (100k epochs)
│                                     # - Evaluation metrics
│                                     # - Model serialization
│
├── suicide_risk_model.pth            # Trained model weights
│                                     # - PyTorch state dictionary
│                                     # - Linear layer parameters
│
├── suicide_risk_synthetic_10k.csv    # Training dataset
│                                     # - 10,000 synthetic records
│                                     # - 14 features + 1 target
│
├── requirements.txt                  # Python dependencies
│
└── README.md                         # Project documentation
```

---

## Deployment Guide

### Backend Deployment (Render)

The FastAPI backend is configured for deployment on Render:

**Production URL**: `https://suicide-risk-prediction-ml-backend.onrender.com`

**Render Configuration**:
- Build Command: `pip install -r requirements.txt`
- Start Command: `uvicorn backend:app --host 0.0.0.0 --port $PORT`

### Frontend Deployment (Streamlit Cloud)

1. Push repository to GitHub
2. Navigate to [Streamlit Cloud](https://streamlit.io/cloud)
3. Connect GitHub repository
4. Configure:
   - Main file path: `app.py`
   - Python version: 3.8+

---

## Configuration

### Backend URL Configuration

Modify the `BACKEND_URL` variable in `app.py` based on your environment:

```python
# Local development
BACKEND_URL = "http://localhost:8000/predict"

# Production
BACKEND_URL = "https://suicide-risk-prediction-ml-backend.onrender.com/predict"
```

### Server Configuration

Modify `backend.py` for custom server settings:

```python
if __name__ == "__main__":
    uvicorn.run(
        app,
        host="0.0.0.0",  # Bind address
        port=8000,        # Port number
        # reload=True,    # Enable for development
    )
```

---

## Troubleshooting

### Common Issues

| Issue | Cause | Solution |
|-------|-------|----------|
| "Backend not reachable" | Backend server not running | Start `backend.py` before frontend |
| Model loading error | Missing `.pth` file | Ensure `suicide_risk_model.pth` exists |
| CORS errors | Frontend/backend port mismatch | Verify CORS origins in `backend.py` |
| Import errors | Missing dependencies | Run `pip install -r requirements.txt` |
| Streamlit won't start | Port 8501 in use | Kill existing process or use `--server.port` |

### Verifying Backend Status

```bash
# Check if backend is running
curl http://localhost:8000/

# Expected response
{"message":"Suicide Risk Prediction API","docs":"/docs"}
```

### Logs and Debugging

Enable debug logging in FastAPI:

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

---

## Contributing

Contributions are welcome. Please follow these guidelines:

### Contribution Process

1. Fork the repository
2. Create a feature branch
   ```bash
   git checkout -b feature/your-feature-name
   ```
3. Make changes and commit
   ```bash
   git commit -m "Add: description of changes"
   ```
4. Push to your fork
   ```bash
   git push origin feature/your-feature-name
   ```
5. Open a Pull Request

### Code Standards

- Follow PEP 8 style guidelines
- Include docstrings for functions and classes
- Add comments for complex logic
- Update documentation as needed

---

## Mental Health Resources

If you or someone you know is struggling with mental health or experiencing thoughts of self-harm, please reach out to professional resources:

### Crisis Helplines

| Region | Service | Contact |
|--------|---------|---------|
| United States | National Suicide Prevention Lifeline | 988 |
| United States | Crisis Text Line | Text HOME to 741741 |
| United Kingdom | Samaritans | 116 123 |
| International | IASP Crisis Centers | [iasp.info/resources/Crisis_Centres](https://www.iasp.info/resources/Crisis_Centres/) |

---

## License

This project is developed for **educational and research purposes only**.

The authors and contributors are not responsible for any misuse of this tool. This software should not be used as a diagnostic tool or substitute for professional mental health evaluation.

---

## Technical References

- [PyTorch Documentation](https://pytorch.org/docs/)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Streamlit Documentation](https://docs.streamlit.io/)
- [scikit-learn Documentation](https://scikit-learn.org/stable/documentation.html)
- [Pydantic Documentation](https://docs.pydantic.dev/)

---

**Repository**: [github.com/yourusername/suicide-risk-prediction-ml](https://github.com/yourusername/suicide-risk-prediction-ml)
